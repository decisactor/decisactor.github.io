import{c as w,$ as i,a as f,_,b as n,n as x,j as a,F as g,k as p,g as v,o,e as b,h as k,t as C,l as d,r as M}from"./index-eba71058.js";import j from"./Circle-6796e60d.js";const I={data(){return{id:"",x:-1,y:-1,cx:-1,cy:-1,x1:-1,y1:-1,x2:-1,y2:-1,color:w,mousedown_:!1}},props:{left:{type:Number},margin:{type:Number},width:{type:Number},height:{type:Number},width_:{type:Number},height_:{type:Number},shape:{type:String},selected:{},objects:{}},methods:{remove(t){return this.$emit("removeItem",i(t.target).attr("id").slice(0,-1)),t},mouseenter(t){return i(t.target).hasClass("rect")&&(i(t.target).css({opacity:.5}),this.$emit("hoverItem",i(t.target).attr("id"))),t},mouseleave(t){return i(t.target).hasClass("rect")&&i(t.target).attr("id")!=this.id&&(i(t.target).css({opacity:0}),this.$emit("hoverItem",null)),t},mousedown(t){return this.mousedown_=!0,this.id=i(t.target).attr("id"),i(t.target).parent().hasClass("drawing")?(this.x1=t.clientX-(i(window).width()-this.width+this.left+24),this.y1=t.clientY-(i(window).height()-this.height+this.margin-(screen.height>800?8:16))):i(t.target).hasClass("circle")?(this.cx=parseFloat(i(t.target).attr("cx")),this.cy=parseFloat(i(t.target).attr("cy")),this.x=t.clientX,this.y=t.clientY):i(t.target).hasClass("rect")&&(this.x=t.clientX,this.y=t.clientY),t},mouseup(t){if(this.shape=="rect"&&this.x2!=this.x1&&this.y2!=this.y1&&this.x2>0&&this.x1>0&&this.y2>0&&this.y1>0){let e=i("#rect"),r=parseFloat(e.attr("x")),y=parseFloat(e.attr("y")),l=parseFloat(e.attr("width")),h=parseFloat(e.attr("height"));this.x1=-1,this.y1=-1,this.x2=-1,this.y2=-1;let u={id_:`rect${this.objects.length?parseInt(this.objects.at(-1).id_.replace("rect",""))+1:0}`,x1:r,y1:y,x2:r+l,y2:y+h,width:l,height:h};this.$emit("setObjects",this.normalize("rect",u),!0)}else if(/rect\d+/.test(i(t.target).attr("id"))){let e=this.objects.find(l=>l.id_==this.id.split("circle")[0]);if(e==null)return t;let r=[],y=[];i(`.${this.id.split("circle")[0]}circle`).each(function(){r.push(parseInt(i(this).attr("cx"))),y.push(parseInt(i(this).attr("cy")))}),e.x1=r.sort((l,h)=>l-h).at(0),e.x2=r.sort((l,h)=>l-h).at(-1),e.y1=y.sort((l,h)=>l-h).at(0),e.y2=y.sort((l,h)=>l-h).at(-1),e.width=e.x2-e.x1,e.height=e.y2-e.y1,this.$emit("setObjects",this.normalize("rect",e),!0)}return this.mousedown_=!1,t},mousemove(t){if(this.mousedown_)if(/circle\d+/.test(this.id))this.cx=this.cx+t.clientX-this.x,this.cy=this.cy+t.clientY-this.y,this.x=t.clientX,this.y=t.clientY,this.circle(this.id);else if(/rect\d+$/.test(this.id)){let e=this.objects.find(r=>r.id_==this.id);e.width*=this.width_,e.x1=e.x1*this.width_-this.x+t.clientX,e.x2=e.x1+e.width,e.height*=this.height_,e.y1=e.y1*this.height_-this.y+t.clientY,e.y2=e.y1+e.height,this.x=t.clientX,this.y=t.clientY,this.$emit("setObjects",this.normalize("rect",e),!1)}else i(t.target).parent().hasClass("drawing")&&this.shape=="rect"&&(this.x2=t.clientX-(i(window).width()-this.width+this.left+24),this.y2=t.clientY-(i(window).height()-this.height+this.margin-(screen.height>800?8:16)));return t},rects(){return this.objects.filter(t=>/rect/.test(t.id_)).map(t=>({id:t.id_,name:t.name,x1:Math.round(t.x1*this.width_),x2:Math.round(t.x2*this.width_),y1:Math.round(t.y1*this.height_),y2:Math.round(t.y2*this.height_),width:Math.round(t.width*this.width_),height:Math.round(t.height*this.height_)}))},click(t){return i(t.target).hasClass("rect")&&(i(".rect",i(t.target).parent().parent().parent()).css({opacity:0}),i(t.target).css({opacity:.5}),this.$emit("hoverItem",i(t.target).attr("id"))),t},circle(t){let e=this.cx,r=this.cy;i(`#${t}`).attr({cx:e,cy:r}),i(`#${t.split("circle")[0]}`).attr({width:0,height:0}),t.split("circle")[1]=="0"&&(i(`#${t.replace(/circle0/,"circle1")}`).attr({cy:r}),i(`#${t.replace(/circle0/,"circle3")}`).attr({cx:e}),i(`#${t.replace(/circle0/,"line0")}`).attr({x1:e,y1:r,y2:r}),i(`#${t.replace(/circle0/,"line1")}`).attr({y1:r}),i(`#${t.replace(/circle0/,"line2")}`).attr({x2:e}),i(`#${t.replace(/circle0/,"line3")}`).attr({x1:e,x2:e,y2:r})),t.split("circle")[1]=="1"&&(i(`#${t.replace(/circle1/,"circle0")}`).attr({cy:r}),i(`#${t.replace(/circle1/,"circle2")}`).attr({cx:e}),i(`#${t.replace(/circle1/,"line0")}`).attr({y1:r,x2:e,y2:r}),i(`#${t.replace(/circle1/,"line1")}`).attr({x1:e,y1:r,x2:e}),i(`#${t.replace(/circle1/,"line2")}`).attr({x1:e}),i(`#${t.replace(/circle1/,"line3")}`).attr({y2:r})),t.split("circle")[1]=="2"&&(i(`#${t.replace(/circle2/,"circle1")}`).attr({cx:e}),i(`#${t.replace(/circle2/,"circle3")}`).attr({cy:r}),i(`#${t.replace(/circle2/,"line0")}`).attr({x2:e}),i(`#${t.replace(/circle2/,"line1")}`).attr({x1:e,x2:e,y2:r}),i(`#${t.replace(/circle2/,"line2")}`).attr({x1:e,y1:r,y2:r}),i(`#${t.replace(/circle2/,"line3")}`).attr({y1:r})),t.split("circle")[1]=="3"&&(i(`#${t.replace(/circle3/,"circle0")}`).attr({cx:e}),i(`#${t.replace(/circle3/,"circle2")}`).attr({cy:r}),i(`#${t.replace(/circle3/,"line0")}`).attr({x1:e}),i(`#${t.replace(/circle3/,"line1")}`).attr({y2:r}),i(`#${t.replace(/circle3/,"line2")}`).attr({y1:r,x2:e,y2:r}),i(`#${t.replace(/circle3/,"line3")}`).attr({x1:e,y1:r,x2:e}))},normalize(t,e){return t=="rect"?{id_:e.id_,name:e.name,x1:e.x1/this.width_,x2:e.x2/this.width_,y1:e.y1/this.height_,y2:e.y2/this.height_,width:e.width/this.width_,height:e.height/this.height_}:{}}},emits:["setObjects","hoverItem","removeItem"],components:{Input:f,Circle:j}};const F={class:"drawing"},X=["width","height"],N={key:0},Y=["x","y","width","height"],z=["x1","y1","x2","y2","id"],B={x:"0",y:"0",width:"1",height:"1",id:"solid"},O=["flood-color"],S=a("feComposite",{in:"SourceGraphic"},null,-1),W=["x","y"],D=["id","x","y"],V=["id","x","y","width","height"];function E(t,e,r,y,l,h){const u=M("Circle");return o(),n("section",F,[(o(),n("svg",{width:r.width_,height:r.height_+12,style:x({marginTop:`${-r.height_-12}px`}),onMousedown:e[7]||(e[7]=(...s)=>h.mousedown&&h.mousedown(...s)),onMousemove:e[8]||(e[8]=(...s)=>h.mousemove&&h.mousemove(...s)),onMouseup:e[9]||(e[9]=(...s)=>h.mouseup&&h.mouseup(...s))},[r.shape=="rect"?(o(),n("g",N,[a("rect",{id:"rect",x:l.x1<l.x2?l.x1:l.x2,y:l.y1<l.y2?l.y1:l.y2,width:l.x2>0&&l.x1>0&&r.shape=="rect"?Math.abs(l.x2-l.x1):0,height:l.y2>0&&l.y1>0&&r.shape=="rect"?Math.abs(l.y2-l.y1):0,style:x({stroke:l.color,strokeWidth:2,fill:"none"})},null,12,Y),(o(!0),n(g,null,p(h.rects(),s=>(o(),n("g",null,[(o(!0),n(g,null,p([[s.x1,s.y1],[s.x2,s.y1],[s.x2,s.y2],[s.x1,s.y2]],(c,m)=>(o(),b(u,{class:k(["circle",`${s.id}circle`]),id:`${s.id}circle${m}`,onCircle:h.circle,circle_:c},null,8,["class","id","onCircle","circle_"]))),256)),(o(!0),n(g,null,p([[s.x1,s.y1,s.x2,s.y1],[s.x2,s.y1,s.x2,s.y2],[s.x2,s.y2,s.x1,s.y2],[s.x1,s.y2,s.x1,s.y1]],(c,m)=>(o(),n("line",{x1:c[0],y1:c[1],x2:c[2],y2:c[3],class:"line",id:`${s.id}line${m}`,style:x({stroke:l.color,strokeWidth:2})},null,12,z))),256)),a("defs",null,[a("filter",B,[a("feFlood",{"flood-color":l.color},null,8,O),S])]),a("text",{class:"name",filter:"url(#solid)",x:s.x1,y:s.y1-4,style:x({display:s.id==r.selected?"unset":"none",fill:"white"})},C(s.name),13,W),a("text",{class:"remove",id:`${s.id}t`,x:s.x2,y:s.y1-4,onClick:e[0]||(e[0]=d((...c)=>h.remove&&h.remove(...c),["stop"])),style:x({display:s.id==r.selected?"unset":"none",fill:l.color})},"X",12,D),a("rect",{class:"rect",id:s.id,x:s.x1,y:s.y1,width:s.width,height:s.height,onMousedown:e[1]||(e[1]=d((...c)=>h.mousedown&&h.mousedown(...c),["stop"])),onMousemove:e[2]||(e[2]=d((...c)=>h.mousemove&&h.mousemove(...c),["stop"])),onMouseup:e[3]||(e[3]=d((...c)=>h.mouseup&&h.mouseup(...c),["stop"])),onMouseenter:e[4]||(e[4]=d((...c)=>h.mouseenter&&h.mouseenter(...c),["stop"])),onMouseleave:e[5]||(e[5]=d((...c)=>h.mouseleave&&h.mouseleave(...c),["stop"])),onClick:e[6]||(e[6]=(...c)=>h.click&&h.click(...c)),style:x({stroke:l.color,strokeWidth:2,fill:l.color,opacity:s.id==r.selected?.5:0})},null,44,V)]))),256))])):v("",!0)],44,X))])}const T=_(I,[["render",E]]);export{T as default};
